"use strict";(self.webpackChunkk8s_security_docs=self.webpackChunkk8s_security_docs||[]).push([[207],{8198:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"security-tools/trivy","title":"Trivy","description":"Trivy is a comprehensive and versatile security scanner. It detects vulnerabilities in container images, file systems, git repositories, and more.","source":"@site/docs/security-tools/trivy.md","sourceDirName":"security-tools","slug":"/security-tools/trivy","permalink":"/docs/security-tools/trivy","draft":false,"unlisted":false,"editUrl":"https://github.com/ThopuriSeetaramaiah/k8s-security-docs/tree/main/docs/security-tools/trivy.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"kube-bench","permalink":"/docs/security-tools/kube-bench"},"next":{"title":"Falco","permalink":"/docs/security-tools/falco"}}');var t=i(4848),a=i(8453);const r={sidebar_position:2},c="Trivy",l={},o=[{value:"Overview",id:"overview",level:2},{value:"Installation",id:"installation",level:2},{value:"macOS",id:"macos",level:3},{value:"Ubuntu/Debian",id:"ubuntudebian",level:3},{value:"RHEL/CentOS",id:"rhelcentos",level:3},{value:"Using Docker",id:"using-docker",level:3},{value:"Basic Usage",id:"basic-usage",level:2},{value:"Scanning Container Images",id:"scanning-container-images",level:3},{value:"Scanning Filesystem",id:"scanning-filesystem",level:3},{value:"Scanning Kubernetes Manifests",id:"scanning-kubernetes-manifests",level:3},{value:"Scanning Infrastructure as Code",id:"scanning-infrastructure-as-code",level:3},{value:"Integration with CI/CD",id:"integration-with-cicd",level:2},{value:"GitHub Actions",id:"github-actions",level:3},{value:"Jenkins Pipeline",id:"jenkins-pipeline",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Advanced Features",id:"advanced-features",level:2},{value:"Custom Policies",id:"custom-policies",level:3},{value:"Offline Scanning",id:"offline-scanning",level:3},{value:"Cache Management",id:"cache-management",level:3},{value:"Limitations",id:"limitations",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"trivy",children:"Trivy"})}),"\n",(0,t.jsx)(n.p,{children:"Trivy is a comprehensive and versatile security scanner. It detects vulnerabilities in container images, file systems, git repositories, and more."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"Trivy is an open-source vulnerability scanner developed by Aqua Security. It's designed to find vulnerabilities in various artifacts, with a focus on container security. Trivy can scan:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Container images"}),"\n",(0,t.jsx)(n.li,{children:"Filesystem directories"}),"\n",(0,t.jsx)(n.li,{children:"Git repositories"}),"\n",(0,t.jsx)(n.li,{children:"Virtual machine images"}),"\n",(0,t.jsx)(n.li,{children:"Kubernetes manifests"}),"\n",(0,t.jsx)(n.li,{children:"Infrastructure as Code (Terraform, CloudFormation, etc.)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.h3,{id:"macos",children:"macOS"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"brew install aquasecurity/trivy/trivy\n"})}),"\n",(0,t.jsx)(n.h3,{id:"ubuntudebian",children:"Ubuntu/Debian"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'apt-get install wget apt-transport-https gnupg lsb-release\nwget -qO - https://aquasecurity.github.io/trivy-repo/deb/public.key | gpg --dearmor | sudo tee /usr/share/keyrings/trivy.gpg > /dev/null\necho "deb [signed-by=/usr/share/keyrings/trivy.gpg] https://aquasecurity.github.io/trivy-repo/deb $(lsb_release -sc) main" | sudo tee /etc/apt/sources.list.d/trivy.list\napt-get update\napt-get install trivy\n'})}),"\n",(0,t.jsx)(n.h3,{id:"rhelcentos",children:"RHEL/CentOS"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"rpm -ivh https://github.com/aquasecurity/trivy/releases/download/v0.36.1/trivy_0.36.1_Linux-64bit.rpm\n"})}),"\n",(0,t.jsx)(n.h3,{id:"using-docker",children:"Using Docker"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker run --rm -v /var/run/docker.sock:/var/run/docker.sock -v $HOME/.cache:/root/.cache aquasec/trivy:latest image nginx:latest\n"})}),"\n",(0,t.jsx)(n.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,t.jsx)(n.h3,{id:"scanning-container-images",children:"Scanning Container Images"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Scan a container image\ntrivy image nginx:latest\n\n# Scan with specific severity levels\ntrivy image --severity HIGH,CRITICAL nginx:latest\n\n# Output in JSON format\ntrivy image --format json --output results.json nginx:latest\n"})}),"\n",(0,t.jsx)(n.h3,{id:"scanning-filesystem",children:"Scanning Filesystem"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Scan a local project directory\ntrivy fs /path/to/project\n\n# Scan for specific vulnerability types\ntrivy fs --vuln-type os,library /path/to/project\n"})}),"\n",(0,t.jsx)(n.h3,{id:"scanning-kubernetes-manifests",children:"Scanning Kubernetes Manifests"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Scan Kubernetes YAML files\ntrivy config --severity HIGH,CRITICAL kubernetes.yaml\n\n# Scan a directory containing Kubernetes manifests\ntrivy config --severity HIGH,CRITICAL ./k8s-manifests/\n"})}),"\n",(0,t.jsx)(n.h3,{id:"scanning-infrastructure-as-code",children:"Scanning Infrastructure as Code"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Scan Terraform files\ntrivy config --severity HIGH,CRITICAL main.tf\n\n# Scan a directory containing Terraform files\ntrivy config --severity HIGH,CRITICAL ./terraform/\n"})}),"\n",(0,t.jsx)(n.h2,{id:"integration-with-cicd",children:"Integration with CI/CD"}),"\n",(0,t.jsx)(n.h3,{id:"github-actions",children:"GitHub Actions"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"name: Trivy Security Scan\n\non:\n  push:\n    branches: [ main ]\n  pull_request:\n    branches: [ main ]\n\njobs:\n  scan:\n    name: Trivy Scan\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v3\n\n      - name: Run Trivy vulnerability scanner\n        uses: aquasecurity/trivy-action@master\n        with:\n          scan-type: 'fs'\n          scan-ref: '.'\n          format: 'table'\n          exit-code: '1'\n          ignore-unfixed: true\n          severity: 'CRITICAL,HIGH'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"jenkins-pipeline",children:"Jenkins Pipeline"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-groovy",children:"pipeline {\n    agent any\n    stages {\n        stage('Scan') {\n            steps {\n                sh 'trivy image --severity HIGH,CRITICAL --no-progress your-image:latest'\n            }\n        }\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Scan Early and Often"}),": Integrate Trivy into your CI/CD pipeline to catch vulnerabilities early"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Focus on Actionable Results"}),": Start by addressing HIGH and CRITICAL vulnerabilities"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Keep Trivy Updated"}),": Regularly update Trivy to get the latest vulnerability database"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use Ignore Files"}),": Create ",(0,t.jsx)(n.code,{children:".trivyignore"})," files for false positives or vulnerabilities you've accepted"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Combine with Other Tools"}),": Use Trivy alongside other security tools for comprehensive coverage"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"advanced-features",children:"Advanced Features"}),"\n",(0,t.jsx)(n.h3,{id:"custom-policies",children:"Custom Policies"}),"\n",(0,t.jsx)(n.p,{children:"Trivy supports custom policies using Open Policy Agent (OPA) and Rego:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"trivy config --policy ./custom-policies/ kubernetes.yaml\n"})}),"\n",(0,t.jsx)(n.h3,{id:"offline-scanning",children:"Offline Scanning"}),"\n",(0,t.jsx)(n.p,{children:"For air-gapped environments:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Download vulnerability database\ntrivy image --download-db-only\n\n# Scan using the downloaded database\ntrivy image --skip-update nginx:latest\n"})}),"\n",(0,t.jsx)(n.h3,{id:"cache-management",children:"Cache Management"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Clear cache\ntrivy image --clear-cache\n\n# Specify cache directory\ntrivy image --cache-dir /path/to/cache nginx:latest\n"})}),"\n",(0,t.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Trivy primarily focuses on known vulnerabilities in packages and dependencies"}),"\n",(0,t.jsx)(n.li,{children:"It may not detect logical vulnerabilities or misconfigurations in custom code"}),"\n",(0,t.jsx)(n.li,{children:"Results depend on the completeness of vulnerability databases"}),"\n",(0,t.jsx)(n.li,{children:"Some vulnerabilities may be false positives if they don't apply to your usage"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.p,{children:["After scanning your container images with Trivy, consider using ",(0,t.jsx)(n.a,{href:"falco",children:"Falco"})," for runtime security monitoring of your Kubernetes workloads."]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>c});var s=i(6540);const t={},a=s.createContext(t);function r(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);