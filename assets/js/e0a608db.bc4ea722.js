"use strict";(self.webpackChunkk8s_security_docs=self.webpackChunkk8s_security_docs||[]).push([[491],{2882:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"security-tools/kube-hunter","title":"kube-hunter","description":"kube-hunter is an open-source tool designed to hunt for security weaknesses in Kubernetes clusters. It performs penetration testing by actively probing for known vulnerabilities and misconfigurations.","source":"@site/docs/security-tools/kube-hunter.md","sourceDirName":"security-tools","slug":"/security-tools/kube-hunter","permalink":"/docs/security-tools/kube-hunter","draft":false,"unlisted":false,"editUrl":"https://github.com/ThopuriSeetaramaiah/k8s-security-docs/tree/main/docs/security-tools/kube-hunter.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Falco","permalink":"/docs/security-tools/falco"},"next":{"title":"CIS Benchmarks","permalink":"/docs/compliance/cis-benchmarks"}}');var t=i(4848),r=i(8453);const o={sidebar_position:4},l="kube-hunter",c={},a=[{value:"Overview",id:"overview",level:2},{value:"How kube-hunter Works",id:"how-kube-hunter-works",level:2},{value:"Installation",id:"installation",level:2},{value:"Using Docker",id:"using-docker",level:3},{value:"Using Python",id:"using-python",level:3},{value:"Usage Modes",id:"usage-modes",level:2},{value:"1. Remote Scanning",id:"1-remote-scanning",level:3},{value:"2. Internal Scanning",id:"2-internal-scanning",level:3},{value:"3. Network Scanning",id:"3-network-scanning",level:3},{value:"Command Line Options",id:"command-line-options",level:2},{value:"Understanding Results",id:"understanding-results",level:2},{value:"Common Vulnerabilities Detected",id:"common-vulnerabilities-detected",level:2},{value:"Integration with CI/CD",id:"integration-with-cicd",level:2},{value:"GitHub Actions Example",id:"github-actions-example",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Active vs. Passive Hunting",id:"active-vs-passive-hunting",level:2},{value:"Limitations",id:"limitations",level:2},{value:"Next Steps",id:"next-steps",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"kube-hunter",children:"kube-hunter"})}),"\n",(0,t.jsx)(n.p,{children:"kube-hunter is an open-source tool designed to hunt for security weaknesses in Kubernetes clusters. It performs penetration testing by actively probing for known vulnerabilities and misconfigurations."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"kube-hunter, developed by Aqua Security, helps security teams and cluster administrators identify security issues in their Kubernetes deployments. It works by scanning Kubernetes clusters, identifying components, and testing for security vulnerabilities."}),"\n",(0,t.jsx)(n.p,{children:"Key features include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Active hunting for security issues"}),"\n",(0,t.jsx)(n.li,{children:"Multiple scanning modes"}),"\n",(0,t.jsx)(n.li,{children:"Comprehensive vulnerability database"}),"\n",(0,t.jsx)(n.li,{children:"Detailed reporting"}),"\n",(0,t.jsx)(n.li,{children:"Easy to use interface"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"how-kube-hunter-works",children:"How kube-hunter Works"}),"\n",(0,t.jsx)(n.p,{children:"kube-hunter operates in three main phases:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Reconnaissance"}),": Discovers Kubernetes components and services"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Vulnerability Scanning"}),": Tests discovered components for known vulnerabilities"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Reporting"}),": Provides detailed information about findings"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.p,{children:"kube-hunter is designed to be run without installation, making it easy to use in various environments."}),"\n",(0,t.jsx)(n.h3,{id:"using-docker",children:"Using Docker"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker run -it --rm aquasec/kube-hunter\n"})}),"\n",(0,t.jsx)(n.h3,{id:"using-python",children:"Using Python"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pip install kube-hunter\nkube-hunter\n"})}),"\n",(0,t.jsx)(n.h2,{id:"usage-modes",children:"Usage Modes"}),"\n",(0,t.jsx)(n.p,{children:"kube-hunter can be run in three different modes:"}),"\n",(0,t.jsx)(n.h3,{id:"1-remote-scanning",children:"1. Remote Scanning"}),"\n",(0,t.jsx)(n.p,{children:"Scans a Kubernetes cluster from outside:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kube-hunter --remote <cluster_ip>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-internal-scanning",children:"2. Internal Scanning"}),"\n",(0,t.jsx)(n.p,{children:"Runs from within the cluster to find internal vulnerabilities:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Using kubectl\nkubectl run kube-hunter --restart=Never -it --rm --image aquasec/kube-hunter -- --pod\n\n# Using Docker in host network mode\ndocker run -it --rm --network host aquasec/kube-hunter\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-network-scanning",children:"3. Network Scanning"}),"\n",(0,t.jsx)(n.p,{children:"Scans a network range for Kubernetes clusters:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kube-hunter --cidr 10.0.0.0/24\n"})}),"\n",(0,t.jsx)(n.h2,{id:"command-line-options",children:"Command Line Options"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Basic scan with interactive mode\nkube-hunter\n\n# Scan specific IP\nkube-hunter --remote 10.0.0.1\n\n# Scan network range\nkube-hunter --cidr 10.0.0.0/24\n\n# Run in pod scanning mode\nkube-hunter --pod\n\n# Generate JSON report\nkube-hunter --report json\n\n# Specify active hunting (attempts exploitation)\nkube-hunter --active\n"})}),"\n",(0,t.jsx)(n.h2,{id:"understanding-results",children:"Understanding Results"}),"\n",(0,t.jsx)(n.p,{children:"kube-hunter categorizes findings into three severity levels:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Low"}),": Informational findings that might help attackers but don't directly lead to compromise"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Medium"}),": Vulnerabilities that could be part of an attack chain"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"High"}),": Critical vulnerabilities that could lead to immediate compromise"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Example report:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"+--------+----------------------+----------------------+----------------------+----------+\n| ID     | LOCATION             | CATEGORY             | VULNERABILITY        | SEVERITY |\n+--------+----------------------+----------------------+----------------------+----------+\n| KHV002 | 10.0.0.1:8080        | Information          | K8s Version          | low      |\n|        |                      | Disclosure           | Disclosure           |          |\n+--------+----------------------+----------------------+----------------------+----------+\n| KHV005 | 10.0.0.1:8080        | Access Risk          | Anonymous            | medium   |\n|        |                      |                      | Authentication       |          |\n+--------+----------------------+----------------------+----------------------+----------+\n| KHV006 | 10.0.0.1:10250       | Remote Code          | Exposed Kubelet      | high     |\n|        |                      | Execution            | API                  |          |\n+--------+----------------------+----------------------+----------------------+----------+\n"})}),"\n",(0,t.jsx)(n.h2,{id:"common-vulnerabilities-detected",children:"Common Vulnerabilities Detected"}),"\n",(0,t.jsx)(n.p,{children:"kube-hunter can detect numerous vulnerabilities, including:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Exposed Dashboards"}),": Kubernetes Dashboard accessible without authentication"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Insecure Ports"}),": Open Kubelet or API server ports"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Anonymous Authentication"}),": API server allowing anonymous access"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Certificate Issues"}),": Weak or misconfigured TLS certificates"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Privileged Containers"}),": Containers running with excessive privileges"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Service Account Misconfigurations"}),": Overly permissive service accounts"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Network Policy Gaps"}),": Missing network policies allowing unrestricted communication"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"integration-with-cicd",children:"Integration with CI/CD"}),"\n",(0,t.jsx)(n.h3,{id:"github-actions-example",children:"GitHub Actions Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"name: Kubernetes Security Scan\n\non:\n  schedule:\n    - cron: '0 0 * * *'  # Daily at midnight\n\njobs:\n  kube-hunter:\n    runs-on: ubuntu-latest\n    steps:\n    - name: Run kube-hunter\n      run: |\n        docker run --rm aquasec/kube-hunter --remote ${{ secrets.CLUSTER_IP }} --report json > kube-hunter-results.json\n    \n    - name: Upload results\n      uses: actions/upload-artifact@v2\n      with:\n        name: kube-hunter-results\n        path: kube-hunter-results.json\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Regular Scanning"}),": Run kube-hunter regularly as part of your security routine"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Scan from Multiple Perspectives"}),": Run both external and internal scans"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Prioritize Remediation"}),": Address high-severity findings first"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use in Non-Production First"}),": Test in development environments before production"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Combine with Other Tools"}),": Use alongside kube-bench and other security tools"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Review Reports Thoroughly"}),": Understand the context of each finding"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"active-vs-passive-hunting",children:"Active vs. Passive Hunting"}),"\n",(0,t.jsx)(n.p,{children:"By default, kube-hunter runs in passive mode, which only identifies vulnerabilities without attempting exploitation. Active mode will attempt to exploit discovered vulnerabilities to confirm their impact:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kube-hunter --active\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsx)(n.p,{children:"Active hunting should only be performed in non-production environments or with explicit permission, as it could potentially disrupt services."})}),"\n",(0,t.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"kube-hunter focuses on known vulnerabilities and may not detect novel security issues"}),"\n",(0,t.jsx)(n.li,{children:"Some vulnerabilities require active exploitation to confirm, which may not be suitable for production"}),"\n",(0,t.jsx)(n.li,{children:"False positives can occur depending on your cluster configuration"}),"\n",(0,t.jsx)(n.li,{children:"Network restrictions may limit the effectiveness of remote scanning"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.p,{children:["After identifying vulnerabilities with kube-hunter, use the ",(0,t.jsx)(n.a,{href:"../compliance/cis-benchmarks",children:"CIS Benchmarks"})," to ensure your cluster meets industry-standard security configurations."]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(6540);const t={},r=s.createContext(t);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);